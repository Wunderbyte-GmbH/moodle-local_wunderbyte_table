define ("local_wunderbyte_table/init",["exports","core/ajax","core/templates","core/notification"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.callLoadData=a.init=void 0;b=e(b);c=e(c);d=e(d);function e(a){return a&&a.__esModule?a:{default:a}}a.init=function init(a,b){console.log("init called",a);if(a&&b){f(a,b,l)}};function f(a,b,c){var d=document.getElementById("a"+a),e=new MutationObserver(function(){if(!g(d)){this.disconnect();c(a,b)}});while(null!==d){if(!g(d)){d=d.parentElement}else{e.observe(d,{attributes:!0});return}}c(a,b)}function g(a){var b=window.getComputedStyle(a);return"none"===b.display||"hidden"===b.visibility}var l=function(a,e){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null,m=4<arguments.length&&arguments[4]!==void 0?arguments[4]:null,n=5<arguments.length&&arguments[5]!==void 0?arguments[5]:null,o=6<arguments.length&&arguments[6]!==void 0?arguments[6]:null,p=7<arguments.length&&arguments[7]!==void 0?arguments[7]:null;console.log("callLoadData "+a);var q=document.getElementById("a"+a),r=document.querySelector("#a"+a+"spinner .spinner-border");console.log("3"+q);console.log("3"+r);r.classList.toggle("hidden");q.classList.toggle("hidden");b.default.call([{methodname:"local_wunderbyte_table_load_data",args:{encodedtable:e,page:f,tsort:g,thide:m,tshow:n,tdir:o,treset:p},done:function done(b){console.log(b);var g=JSON.parse(b.content);c.default.renderForPromise(b.template,g).then(function(b){var d=b.html,g=b.js;console.log(g);var l=document.querySelector("#a"+a);while(l.firstChild){l.removeChild(q.lastChild)}c.default.appendNodeContents("#a"+a,d,g);console.log("works");console.log(l);if(!f){var m=l.querySelector("li.page-item active");if(m){f=m.getAttribute("data-page-number")}}k(a,e,l);i(a,e,l,f);j(a,e,l);h(a,e,l,f);return!0}).catch(function(a){d.default.addNotification({message:"failed rendering "+a,type:"danger"})});r.classList.add("hidden");q.classList.remove("hidden");return!0},fail:function fail(b){if(1!=p){l(a,e,f,null,null,null,null,1)}else{var c=document.createElement("DIV"),d=document.createTextNode(b.message);c.appendChild(d);q.appendChild(c);r.classList.add("hidden");q.classList.remove("hidden")}}}])};a.callLoadData=l;function h(a,b,c,d){var e=c.querySelectorAll("th.header a");e.forEach(function(c){var e=c.getAttribute("data-sortby"),f=c.getAttribute("data-sortorder"),g="hide"==c.getAttribute("data-action")?c.getAttribute("data-column"):null,h="show"==c.getAttribute("data-action")?c.getAttribute("data-column"):null;c.setAttribute("href","#");c.addEventListener("click",function(){l(a,b,d,e,g,h,f)})})}function i(a,b,c,d){var e=c.querySelectorAll("div.resettable");if(!e||0==e.length){return}e.forEach(function(c){var e=c.getAttribute("class");if(0<=e.indexOf("resettable")){var f=c.querySelectorAll("a");f.forEach(function(c){c.setAttribute("href","#");c.addEventListener("click",function(){l(a,b,d,null,null,null,null,1)})})}})}function j(a,b,c){var d=c.querySelectorAll(".page-item");if(!d||0==d.length){return}d.forEach(function(c){var d=c.dataset.pagenumber;if(d){--d;c.addEventListener("click",function(){l(a,b,d)})}})}function k(a,b,c){var d=c.querySelectorAll("form");d.forEach(function(a){if("FORM"==a.tagName){a.setAttribute("method","POST");var c=document.createElement("input");c.setAttribute("type","hidden");c.setAttribute("name","encodedtable");c.setAttribute("value",b);a.appendChild(c)}})}});
//# sourceMappingURL=init.min.js.map

define("local_wunderbyte_table/reordering",["exports","core/sortable_list","jquery","local_wunderbyte_table/actionbutton"],(function(_exports,_sortable_list,_jquery,_actionbutton){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Javascript for sorting columns in question bank view.
   *
   * @copyright  2024 Wunderbyte GmbH
   * @author     Georg MaiÃŸer
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.initializeReordering=function(listContainer,idstring,encodedtable){const container=document.querySelector(listContainer);if(!container)return;const rowscontainer=container.querySelector(`${SELECTOR_ROWS}`);if(!rowscontainer||rowscontainer.dataset.sortinitialized)return;rowscontainer.dataset.sortinitialized=!0,((listRoot,identifier,idstring,encodedtable)=>{new _sortable_list.default(listRoot),(0,_jquery.default)(identifier+" > *").on(_sortable_list.default.EVENTS.DROP,(function(event,info){if(console.log("drop",event.currentTarget),info.positionChanged&&activeinfo!=info){activeinfo=info;const data={ids:getIdOrder(listRoot)},datastring=JSON.stringify(data);(0,_actionbutton.transmitAction)(-1,"reorderrows",datastring,idstring,encodedtable),listRoot.querySelectorAll("tr").forEach((item=>item.classList.remove("wb-table-sortable-drag"))),listRoot.querySelectorAll("tr").forEach((item=>item.classList.remove("wb-table-sortable-active")))}})),(0,_jquery.default)(identifier+" > *").on(_sortable_list.default.EVENTS.DRAGSTART,(event=>{console.log("dragstart",event.currentTarget),event.currentTarget.classList.add("wb-table-sortable-active")})),(0,_jquery.default)(identifier+" > *").on(_sortable_list.default.EVENTS.DRAG,(event=>{console.log("drag",event.currentTarget),event.currentTarget.classList.add("wb-table-sortable-drag")})),(0,_jquery.default)(identifier+" > *").on(_sortable_list.default.EVENTS.DAGEND,(event=>{console.log("dragend",event.currentTarget),listRoot.querySelectorAll("tr").forEach((item=>item.classList.remove("wb-table-sortable-drag"))),listRoot.querySelectorAll("tr").forEach((item=>item.classList.remove("wb-table-sortable-active")))}))})(rowscontainer,SELECTOR_ROWS,idstring,encodedtable)},_sortable_list=_interopRequireDefault(_sortable_list),_jquery=_interopRequireDefault(_jquery);const SELECTOR_ROWS=".rows-container";var activeinfo=null;const getIdOrder=listRoot=>{const columns=Array.from(listRoot.querySelectorAll("tr[data-id]")).map((column=>column.dataset.id));return columns.pop(),columns}}));

//# sourceMappingURL=reordering.min.js.map
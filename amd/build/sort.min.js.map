{"version":3,"sources":["../src/sort.js"],"names":["listContainer","idstring","encodedtable","container","document","querySelector","sortColumnElement","sortOrderElement","dataset","initialized","addEventListener","e","callSortAjax","inputElement","event","sortcolumn","sortorder","reset","className","target","value","includes","replace","selectedOptions","filterobjects","searchstring"],"mappings":"iPAiCQ,SAAwBA,CAAxB,CAAuCC,CAAvC,CAAiDC,CAAjD,CAA+D,IAE7DC,CAAAA,CAAS,CAAGC,QAAQ,CAACC,aAAT,CAAuBL,CAAvB,CAFiD,CAI7DM,CAAiB,CAAGH,CAAS,CAACE,aAAV,CAAwB,mBAAxB,CAJyC,CAK7DE,CAAgB,CAAGJ,CAAS,CAACE,aAAV,CAAwB,mBAAxB,CAL0C,CAOnE,GAAI,CAACC,CAAD,EAAsB,CAACC,CAA3B,CAA6C,CAEzC,MACH,CAED,GAAI,CAACD,CAAiB,CAACE,OAAlB,CAA0BC,WAA3B,EAA0C,CAACF,CAAgB,CAACC,OAAjB,CAAyBC,WAAxE,CAAqF,CAEnFH,CAAiB,CAACE,OAAlB,CAA0BC,WAA1B,IACAF,CAAgB,CAACC,OAAjB,CAAyBC,WAAzB,IAIAH,CAAiB,CAACI,gBAAlB,CAAmC,QAAnC,CAA6C,SAACC,CAAD,CAAO,CAClDC,CAAY,CAACD,CAAD,CAAIV,CAAJ,CAAcC,CAAd,CACb,CAFD,EAGAK,CAAgB,CAACG,gBAAjB,CAAkC,OAAlC,CAA2C,UAAM,CAC/CE,CAAY,CAAC,IAAD,CAAOX,CAAP,CAAiBC,CAAjB,CACb,CAFD,CAGD,CACJ,C,oBA8EM,SAA0BD,CAA1B,CAAoC,CAEzC,GAAMY,CAAAA,CAAY,CAAGT,QAAQ,CAACC,aAAT,CAAuB,+BAAiCJ,CAAjC,CAA4C,cAAnE,CAArB,CAEA,GAAI,CAACY,CAAL,CAAmB,CACjB,MAAO,KACR,CAED,MAAO,EACR,C,CA/ED,QAASD,CAAAA,CAAT,CAAsBE,CAAtB,CAA6Bb,CAA7B,CAAuCC,CAAvC,CAAqD,IAE/Ca,CAAAA,CAAU,CAAG,IAFkC,CAG/CC,CAAS,CAAG,IAHmC,CAI/CC,CAAK,CAAG,IAJuC,CAM7Cd,CAAS,CAAGC,QAAQ,CAACC,aAAT,CAAuB,+BAAiCJ,CAAxD,CANiC,CAO7CK,CAAiB,CAAGH,CAAS,CAACE,aAAV,CAAwB,mBAAxB,CAPyB,CAQ/Ca,CAAS,CAAGf,CAAS,CAACE,aAAV,CAAwB,qBAAxB,EAA+Ca,SARZ,CAWnD,GAAc,IAAV,GAAAJ,CAAJ,CAAoB,CAElBC,CAAU,CAAGD,CAAK,CAACK,MAAN,CAAaC,KAA1B,CAEAH,CAAK,CAAG,CAAR,CAEA,GAAI,CAACF,CAAL,CAAiB,CACf,MACD,CAGD,GAAIG,CAAS,CAACG,QAAV,CAAmB,KAAnB,CAAJ,CAA+B,CAE7BL,CAAS,CAAG,CACb,CAHD,IAGO,CAELA,CAAS,CAAG,CACb,CAEF,CAnBD,IAmBO,CAKL,GAAIE,CAAS,CAACG,QAAV,CAAmB,KAAnB,CAAJ,CAA+B,CAE7BL,CAAS,CAAG,CAAZ,CACAb,CAAS,CAACE,aAAV,CAAwB,qBAAxB,EAA+Ca,SAA/C,CAA2DA,CAAS,CAACI,OAAV,CAAkB,KAAlB,CAAyB,MAAzB,CAC5D,CAJD,IAIO,CAELN,CAAS,CAAG,CAAZ,CACAb,CAAS,CAACE,aAAV,CAAwB,qBAAxB,EAA+Ca,SAA/C,CAA2DA,CAAS,CAACI,OAAV,CAAkB,MAAlB,CAA0B,KAA1B,CAC5D,CAGDP,CAAU,CAAGT,CAAiB,CAACiB,eAAlB,CAAkC,CAAlC,EAAqCH,KACnD,CA/CkD,GAiD5CI,CAAAA,CAAa,CAAG,sBAAgBvB,CAAhB,CAjD4B,CAkD5CwB,CAAY,CAAG,qBAAexB,CAAf,CAlD6B,CAqDlD,mBAAaA,CAAb,CACEC,CADF,CAEE,CAFF,CAGEa,CAHF,CAIE,IAJF,CAKE,IALF,CAMEC,CANF,CAOEC,CAPF,CAQEO,CARF,CASEC,CATF,CAUF,C","sourcesContent":["\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @package    local_wunderbyte_table\n * @copyright  Wunderbyte GmbH <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {callLoadData} from 'local_wunderbyte_table/init';\nimport {getFilterOjects} from 'local_wunderbyte_table/filter';\nimport {getSearchInput} from 'local_wunderbyte_table/search';\n\n/**\n * Function to initialize the search after rendering the searchbox.\n * @param {*} listContainer\n * @param {*} idstring\n * @param {*} encodedtable\n * @returns {void}\n */\n export function initializeSort(listContainer, idstring, encodedtable) {\n\n    const container = document.querySelector(listContainer);\n\n    const sortColumnElement = container.querySelector('select.sortcolumn');\n    const sortOrderElement = container.querySelector('a.changesortorder');\n\n    if (!sortColumnElement || !sortOrderElement) {\n\n        return;\n    }\n\n    if (!sortColumnElement.dataset.initialized || !sortOrderElement.dataset.initialized) {\n\n      sortColumnElement.dataset.initialized = true;\n      sortOrderElement.dataset.initialized = true;\n\n      // We add to listener, on on the select, one on the sortorder button.\n\n      sortColumnElement.addEventListener('change', (e) => {\n        callSortAjax(e, idstring, encodedtable);\n      });\n      sortOrderElement.addEventListener('click', () => {\n        callSortAjax(null, idstring, encodedtable);\n      });\n    }\n}\n\n/**\n * Execture the two possible sort Ajax calls as reaction on the triggered event.\n * @param {*} event\n * @param {*} idstring\n * @param {*} encodedtable\n */\nfunction callSortAjax(event, idstring, encodedtable) {\n\n  let sortcolumn = null;\n  let sortorder = null;\n  let reset = null;\n\n  const container = document.querySelector(\".wunderbyte_table_container_\" + idstring);\n  const sortColumnElement = container.querySelector('select.sortcolumn');\n  let className = container.querySelector(\"a.changesortorder i\").className;\n\n  // If we get an event, we are in the sortcolum mode.\n  if (event !== null) {\n\n    sortcolumn = event.target.value;\n    // We reset only on changed sortcolumn, not on order.\n    reset = 1;\n\n    if (!sortcolumn) {\n      return;\n    }\n\n    // Get the sortorder by the icon and apply it.\n    if (className.includes('asc')) {\n\n      sortorder = 4;\n    } else {\n\n      sortorder = 3;\n    }\n\n  } else {\n    // Else, we are in the sortorder mode.\n    // 3 is ASC, 4 is DESC. We have to find out which is the current mode.\n\n    // Get the sortorder by the icon and change it.\n    if (className.includes('asc')) {\n\n      sortorder = 3;\n      container.querySelector(\"a.changesortorder i\").className = className.replace('asc', 'desc');\n    } else {\n\n      sortorder = 4;\n      container.querySelector(\"a.changesortorder i\").className = className.replace('desc', 'asc');\n    }\n\n    // We also need the sortcolumn name to effectuate the change.\n    sortcolumn = sortColumnElement.selectedOptions[0].value;\n  }\n\n   const filterobjects = getFilterOjects(idstring);\n   const searchstring = getSearchInput(idstring);\n\n\n   callLoadData(idstring,\n     encodedtable,\n     0, // We set page to 0 because we need to start the container anew.\n     sortcolumn,\n     null,\n     null,\n     sortorder,\n     reset,\n     filterobjects,\n     searchstring);\n}\n\n/**\n * Function to read the searchstring from the input leement.\n * @param {*} idstring\n * @returns {null|string}\n */\nexport function getSortSelection(idstring) {\n\n  const inputElement = document.querySelector(\".wunderbyte_table_container_\" + idstring + ' select.sort');\n\n  if (!inputElement) {\n    return null;\n  }\n\n  return '';\n}\n"],"file":"sort.min.js"}
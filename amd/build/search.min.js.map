{"version":3,"sources":["../src/search.js"],"names":["checked","categories","allElements","init","listContainerSelector","elementToHide","elementToSearch","console","log","inputElement","document","querySelector","addEventListener","searchInput","listContainer","allCheckboxes","initializeCheckboxes","selector","querySelectorAll","forEach","e","push","getAttribute","getChecked","el","toggleCheckbox","filter","li","a","i","txtValue","value","toUpperCase","length","textContent","innerText","indexOf","style","display","target","name","setVisibility","Array","from","map","c","classList","intersection","Object","values","dataset","x","includes","renderFilter","filterjson","idstring","Templates","renderForPromise","then","html","container","insertAdjacentHTML","catch"],"mappings":"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","sourcesContent":["\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @package    local_wunderbyte_table\n * @copyright  Wunderbyte GmbH <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Templates from 'core/templates';\n\nvar checked = {};\nvar categories = [];\nvar allElements = [];\n\nexport const init = (listContainerSelector, elementToHide, elementToSearch) => {\n\n    // eslint-disable-next-line no-console\n    console.log(listContainerSelector, elementToHide, elementToSearch);\n\n    const inputElement = document.querySelector(listContainerSelector + ' input.search');\n\n    if (!inputElement) {\n        return;\n    }\n\n    inputElement.addEventListener('keyup', () => {\n\n        searchInput(inputElement, elementToHide, elementToSearch);\n    });\n\n    const listContainer = document.querySelector(listContainerSelector);\n\n    // eslint-disable-next-line no-console\n    console.log('listContainer ', listContainer);\n\n    const allCheckboxes = listContainer.querySelector(\"input[type=checkbox]\");\n\n    if (!allCheckboxes) {\n        return;\n    }\n};\n\n/**\n * Initialize Checkboxes.\n * @param {string} selector\n * @returns\n */\nfunction initializeCheckboxes(selector) {\n\n    // eslint-disable-next-line no-console\n    console.log('initializeCheckboxes ');\n\n    const listContainer = document.querySelector(selector);\n\n    const allCheckboxes = listContainer.querySelectorAll(\"input[type=checkbox]\");\n\n    if (!allCheckboxes) {\n        return;\n    }\n\n    // eslint-disable-next-line no-console\n    console.log('allCheckboxes ', allCheckboxes);\n\n    listContainer.querySelectorAll(\".form-group\").forEach(e => {\n        categories.push(e.getAttribute(\"name\"));\n        getChecked(e.getAttribute(\"name\"));\n    });\n\n    allCheckboxes.forEach(el => {\n        el.addEventListener(\"change\", toggleCheckbox);\n    });\n\n\n}\n\nexport const searchInput = (inputElement, elementToHide, elementToSearch) => {\n    let filter, li, a, i, txtValue;\n\n    filter = inputElement.value.toUpperCase();\n\n    // eslint-disable-next-line no-console\n    console.log(filter);\n\n    li = document.querySelectorAll(elementToHide);\n\n    // eslint-disable-next-line no-console\n    console.log(li);\n\n    for (i = 0; i < li.length; i++) {\n        if (elementToSearch) {\n            a = li[i].querySelector(elementToSearch);\n        } else {\n            a = li[i];\n        }\n\n        txtValue = a.textContent || a.innerText;\n\n        // eslint-disable-next-line no-console\n        console.log(txtValue);\n\n        if (txtValue.toUpperCase().indexOf(filter) > -1) {\n            li[i].style.display = \"\";\n        } else {\n            li[i].style.display = \"none\";\n        }\n    }\n};\n\n\n/**\n * Eventhandler\n *\n * @param {*} e - event\n */\n export const toggleCheckbox = (e) => {\n    getChecked(e.target.name);\n    setVisibility();\n  };\n\n  /**\n   * Check which Checkboxes are selected inside a group.\n   *\n   * @param {*} name of Element group\n   */\n  export const getChecked = (name) => {\n    checked[name] = Array.from(\n      document.querySelectorAll(\"input[name=\" + name + \"]:checked\")\n    ).map(function(el) {\n      return el.value;\n    });\n  };\n\n  /**\n   * Compares checked boxes with classes of Elements and shows or hides them.\n   */\n  export const setVisibility = () => {\n\n    // eslint-disable-next-line no-console\n    console.log(categories);\n    allElements.forEach(function(el) {\n      let display = true;\n      categories.forEach(function(c) {\n\n        // eslint-disable-next-line no-console\n        console.log(el.classList);\n        let intersection = checked[c].length\n          ? Array.from(Object.values(el.dataset)).filter((x) =>\n              checked[c].includes(x)\n            ).length\n          : true;\n        if (!intersection) {\n          display = false;\n          return;\n        }\n      });\n      if (display) {\n        el.style.display = \"block\";\n      } else {\n        el.style.display = \"none\";\n      }\n    });\n  };\n\n\n  /**\n   * Render the checkboxes for the filer.\n   * @param {string} filterjson\n   * @param {string} idstring\n   */\n  export const renderFilter = (filterjson, idstring) => {\n\n    // eslint-disable-next-line no-console\n    console.log('filterjson', filterjson);\n\n    Templates.renderForPromise('local_wunderbyte_table/filter', filterjson).then(({html}) => {\n\n        // eslint-disable-next-line no-console\n        console.log('renderFilter', html);\n        const selector = \".wunderbyte_table_container_\" + idstring;\n\n        // eslint-disable-next-line no-console\n        console.log('selector', selector);\n\n        const container = document.querySelector(selector);\n\n        // eslint-disable-next-line no-console\n        console.log(container);\n\n        container.insertAdjacentHTML('afterbegin', html);\n\n        initializeCheckboxes(selector);\n\n        return;\n    }).catch(e => {\n        // eslint-disable-next-line no-console\n        console.log(e);\n    });\n};\n"],"file":"search.min.js"}
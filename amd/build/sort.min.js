define("local_wunderbyte_table/sort",["exports","local_wunderbyte_table/init","local_wunderbyte_table/filter","local_wunderbyte_table/search"],(function(_exports,_init,_filter,_search){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.getSortSelection=function(idstring){if(!document.querySelector(SELECTOR_WBCONTAINER+idstring+" select.sort"))return null;return""},_exports.initializeSort=function(listContainer,idstring,encodedtable){const container=document.querySelector(listContainer);if(!container)return;const sortColumnElement=container.querySelector(SELECTOR_SORTCOLUMN),sortOrderElement=container.querySelector(SELECTOR_CHANGESORTORDER);if(initializeSortColumns(listContainer,idstring,encodedtable),!sortColumnElement||!sortOrderElement)return;sortColumnElement.dataset.initialized&&sortOrderElement.dataset.initialized||(sortColumnElement.dataset.initialized=!0,sortOrderElement.dataset.initialized=!0,sortColumnElement.addEventListener("change",(e=>{callSortAjax(e,idstring,encodedtable)})),sortOrderElement.addEventListener("click",(()=>{callSortAjax(null,idstring,encodedtable)})),sortOrderElement.addEventListener("keydown",(event=>{"Enter"===event.key&&callSortAjax(null,idstring,encodedtable)})))},_exports.initializeSortColumns=initializeSortColumns;
/**
   * @module    local_wunderbyte_table
   * @copyright  Wunderbyte GmbH <info@wunderbyte.at>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
const SELECTOR_SORTCOLUMN="select.sortcolumn",SELECTOR_CHANGESORTORDER="a.changesortorder",SELECTOR_TABLECOLUMN="th.wb-table-column",SELECTOR_WBCONTAINER=".wunderbyte_table_container_",SELECTOR_CHECKBOXES="input.wb-checkbox",SELECTOR_TABLEHEADERCHECKBOX="input.tableheadercheckbox";function initializeSortColumns(listContainer,idstring,encodedtable){const container=document.querySelector(listContainer);container.querySelectorAll(SELECTOR_TABLECOLUMN).forEach((element=>{element.dataset.initialized||(element.dataset.initialized=!0,element.addEventListener("click",(e=>{let columnname=element.dataset.columnname;if("wbcheckbox"===columnname){var checked=container.querySelector(SELECTOR_TABLEHEADERCHECKBOX).checked;!function(idstring,checked){const container=document.querySelector("#a"+idstring);container.querySelectorAll(SELECTOR_CHECKBOXES).forEach((x=>{x.dataset.tableid==idstring&&(x.checked=checked)}))}(idstring,checked),e.target.dataset.checked=checked}else element.dataset.sortable&&callSortAjax(columnname,idstring,encodedtable)})))}))}function callSortAjax(event,idstring,encodedtable){let sortcolumn=null,sortorder=null,reset=null;const container=document.querySelector(SELECTOR_WBCONTAINER+idstring),sortColumnElement=container.querySelector(SELECTOR_SORTCOLUMN);let sortOrderElement=container.querySelector("a.changesortorder i"),className=null,columnheaderIsTrigger=!1;if("string"==typeof event&&(sortOrderElement=container.querySelector(SELECTOR_TABLECOLUMN+"."+event),columnheaderIsTrigger=!0),className=sortOrderElement.className,null!==event){if(sortcolumn="string"==typeof event?event:event.target.value,reset=1,!sortcolumn)return;console.log("Classname ",className),sortorder=className.includes("desc")&&0==columnheaderIsTrigger||className.includes("asc")&&1==columnheaderIsTrigger?3:4}else className.includes("asc")?(sortorder=3,sortOrderElement.className=className.replace("asc","desc")):(sortorder=4,sortOrderElement.className=className.replace("desc","asc")),sortcolumn=sortColumnElement.selectedOptions[0].value;const filterobjects=(0,_filter.getFilterObjects)(idstring),searchstring=(0,_search.getSearchInput)(idstring);(0,_init.callLoadData)(idstring,encodedtable,0,sortcolumn,null,null,sortorder,reset,filterobjects,searchstring)}}));

//# sourceMappingURL=sort.min.js.map
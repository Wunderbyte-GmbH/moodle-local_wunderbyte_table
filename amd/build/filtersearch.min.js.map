{"version":3,"file":"filtersearch.min.js","sources":["../src/filtersearch.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @package    local_wunderbyte_table\n * @copyright  Wunderbyte GmbH <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\n/**\n * Render the checkboxes for the filer.\n * @param {string} idstring\n */\nexport const renderSearchbox = (idstring) => {\n\n    const selector = \".wunderbyte_table_container_\" + idstring;\n    const tablecontainer = document.querySelector(selector);\n    if (!tablecontainer) {\n        return;\n    }\n    const filtercontainer = tablecontainer.querySelector(\".wunderbyteTableFilter\");\n    if (!filtercontainer) {\n        return;\n    }\n    let searchfields = filtercontainer.querySelectorAll(\"input.search\");\n\n    // eslint-disable-next-line no-console\n    console.log(\"filtersearch init\", searchfields);\n\n    if (!searchfields) {\n        return;\n    }\n};\n\n\n/**\n * Function to initialize the search after rendering each searchfield.\n * @param {*} containerselector\n */\nexport function initializeFilterSearch(containerselector) {\n\n    const tablecontainer = document.querySelector(containerselector);\n    if (!tablecontainer) {\n        return;\n    }\n    const filtercontainer = tablecontainer.querySelector(\".wunderbyteTableFilter\");\n\n    if (!filtercontainer) {\n        return;\n    }\n    var inputElements = filtercontainer.querySelectorAll('input.search');\n\n    if (!inputElements) {\n        return;\n    }\n\n    inputElements.forEach(function(inputElement) {\n        if (!inputElement.dataset.initialized) {\n            inputElement.dataset.initialized = true;\n\n            // Get all records of filter.\n            const parentElement = inputElement.parentNode;\n            let records = parentElement.querySelectorAll('input.filterelement.form-check-input[type=\"checkbox\"]');\n\n            // Display searchfield with minimum of 13 records.\n            if (records.length > 0) {\n                inputElement.removeAttribute('hidden');\n            }\n\n            inputElement.addEventListener('keyup', () => {\n\n                let searchstring = null;\n                let match = false;\n                if (inputElement.value.length > 1\n                    || inputElement.value.length === 0) {\n                    searchstring = inputElement.value;\n                }\n\n                if (inputElement.value.length === 0 && inputElement.nextElementSibling.dataset.moodletype == 'hierarchylist') {\n                    match = false;\n                }\n\n                // Check if value of records contains searchstring.\n                // If countained, display it, else hide.\n                records.forEach(function(record) {\n                    let value = record.value.toLowerCase();\n                    const listelement = record.parentNode;\n                    if (value.includes(searchstring.toLowerCase())) {\n                        match = true;\n                        listelement.removeAttribute('hidden');\n                    } else {\n                        listelement.setAttribute('hidden', '');\n                    // For hierarchy filter. Only do once for current parent.\n                }\n                    if (match === true) {\n                        listelement.parentNode.parentNode.classList.add('show');\n                    } else {\n                        listelement.parentNode.parentNode.classList.remove('show');\n                    }\n                });\n                return;\n            });\n        }\n    }\n    );\n}\n"],"names":["containerselector","tablecontainer","document","querySelector","filtercontainer","inputElements","querySelectorAll","forEach","inputElement","dataset","initialized","records","parentNode","length","removeAttribute","addEventListener","searchstring","match","value","nextElementSibling","moodletype","record","toLowerCase","listelement","includes","setAttribute","classList","add","remove","idstring","selector","searchfields","console","log"],"mappings":"8KAoDuCA,yBAE7BC,eAAiBC,SAASC,cAAcH,uBACzCC,4BAGCG,gBAAkBH,eAAeE,cAAc,8BAEhDC,2BAGDC,cAAgBD,gBAAgBE,iBAAiB,oBAEhDD,qBAILA,cAAcE,SAAQ,SAASC,kBACtBA,aAAaC,QAAQC,YAAa,CACnCF,aAAaC,QAAQC,aAAc,MAI/BC,QADkBH,aAAaI,WACPN,iBAAiB,yDAGzCK,QAAQE,OAAS,GACjBL,aAAaM,gBAAgB,UAGjCN,aAAaO,iBAAiB,SAAS,SAE/BC,aAAe,KACfC,OAAQ,GACRT,aAAaU,MAAML,OAAS,GACK,IAA9BL,aAAaU,MAAML,UACtBG,aAAeR,aAAaU,OAGE,IAA9BV,aAAaU,MAAML,QAAsE,iBAAtDL,aAAaW,mBAAmBV,QAAQW,aAC3EH,OAAQ,GAKZN,QAAQJ,SAAQ,SAASc,YACjBH,MAAQG,OAAOH,MAAMI,oBACnBC,YAAcF,OAAOT,WACvBM,MAAMM,SAASR,aAAaM,gBAC5BL,OAAQ,EACRM,YAAYT,gBAAgB,WAE5BS,YAAYE,aAAa,SAAU,KAGzB,IAAVR,MACAM,YAAYX,WAAWA,WAAWc,UAAUC,IAAI,QAEhDJ,YAAYX,WAAWA,WAAWc,UAAUE,OAAO,4EApF3CC,iBAEtBC,SAAW,+BAAiCD,SAC5C5B,eAAiBC,SAASC,cAAc2B,cACzC7B,4BAGCG,gBAAkBH,eAAeE,cAAc,8BAChDC,2BAGD2B,aAAe3B,gBAAgBE,iBAAiB,gBAGpD0B,QAAQC,IAAI,oBAAqBF"}
{"version":3,"file":"edittable.min.js","sources":["../src/edittable.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @package    local_shopping_cart\n * @copyright  Wunderbyte GmbH <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport ModalForm from 'core_form/modalform';\nimport {reinit} from 'local_shopping_cart/cart';\nimport {get_string as getString} from 'core/str';\n\nconst SELECTORS = {\n    EDITTABLEBUTTON: ' .wb_edit_button',\n};\n\n/**\n * Init function.\n * @param {*} selector\n * @param {*} idstring\n * @param {*} encodedtable\n * @returns\n */\nexport function initializeEditTableButton(selector, idstring, encodedtable) {\n\n    const button = document.querySelector(selector + SELECTORS.EDITTABLEBUTTON);\n\n    if (!button) {\n        return;\n    }\n\n    // eslint-disable-next-line no-console\n    console.log('run initializeEditTableButton');\n\n    if (button.initialized) {\n        return;\n    } else {\n        button.initialized = true;\n    }\n\n    button.addEventListener('click', (e) => editTableModal(e, idstring, encodedtable));\n}\n\n/**\n * Edit Table Modal.\n * @param {*} event\n * @param {*} idstring\n * @param {*} encodedtable\n */\nexport function editTableModal(event, idstring, encodedtable) {\n\n    // We two parents up, we find the right element with the necessary information.\n    const element = event.target;\n\n    // eslint-disable-next-line no-console\n    console.log('closest', element);\n\n    // eslint-disable-next-line no-console\n    console.log('values ', idstring);\n\n    const modalForm = new ModalForm({\n\n        // Name of the class where form is defined (must extend \\core_form\\dynamic_form):\n        formClass: \"local_wunderbyte_table\\\\form\\\\edittable\",\n        // Add as many arguments as you need, they will be passed to the form:\n        args: {\n            idstring,\n            encodedtable,\n        },\n        // Pass any configuration settings to the modal dialogue, for example, the title:\n        modalConfig: {title: getString('edittable', 'local_wunderbyte_table')},\n        // DOM element that should get the focus after the modal dialogue is closed:\n        returnFocus: element\n    });\n    // Listen to events if you want to execute something on form submit.\n    // Event detail will contain everything the process() function returned:\n    modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, response => {\n\n        // eslint-disable-next-line no-console\n        console.log('form submitted response: ', response);\n        reinit();\n\n    });\n\n    // Show the form.\n    modalForm.show();\n\n}\n"],"names":["selector","idstring","encodedtable","button","document","querySelector","SELECTORS","console","log","initialized","addEventListener","e","editTableModal","event","element","target","modalForm","ModalForm","formClass","args","modalConfig","title","returnFocus","events","FORM_SUBMITTED","response","show"],"mappings":";;;;;gJAmC0CA,SAAUC,SAAUC,oBAEpDC,OAASC,SAASC,cAAcL,SAAWM,+BAE5CH,iBAKLI,QAAQC,IAAI,iCAERL,OAAOM,mBAGPN,OAAOM,aAAc,EAGzBN,OAAOO,iBAAiB,SAAUC,GAAMC,eAAeD,EAAGV,SAAUC,qFA5BlEI,0BACe,4BAoCLM,eAAeC,MAAOZ,SAAUC,oBAGtCY,QAAUD,MAAME,OAGtBR,QAAQC,IAAI,UAAWM,SAGvBP,QAAQC,IAAI,UAAWP,gBAEjBe,UAAY,IAAIC,mBAAU,CAG5BC,UAAW,0CAEXC,KAAM,CACFlB,SAAAA,SACAC,aAAAA,cAGJkB,YAAa,CAACC,OAAO,mBAAU,YAAa,2BAE5CC,YAAaR,UAIjBE,UAAUN,iBAAiBM,UAAUO,OAAOC,gBAAgBC,WAGxDlB,QAAQC,IAAI,4BAA6BiB,gCAM7CT,UAAUU"}
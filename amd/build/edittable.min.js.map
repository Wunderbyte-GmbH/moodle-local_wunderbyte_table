{"version":3,"file":"edittable.min.js","sources":["../src/edittable.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @package    local_shopping_cart\n * @copyright  Wunderbyte GmbH <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport ModalForm from 'core_form/modalform';\nimport {get_string as getString} from 'core/str';\nimport {init as filterFieldsInit} from 'local_wunderbyte_table/filterfieldsreload';\n\nconst SELECTORS = {\n    EDITTABLEBUTTON: ' .wb_edit_button',\n    ADDFILTERBUTTON: ' .wb_add_filter_button',\n};\n\n/**\n * Init function.\n * @param {*} selector\n * @param {*} idstring\n * @param {*} encodedtable\n */\nexport function initializeEditTableButton(selector, idstring, encodedtable) {\n\n    const button = document.querySelector(selector + SELECTORS.EDITTABLEBUTTON);\n\n    if (!button) {\n        return;\n    }\n\n    if (button.initialized) {\n        return;\n    } else {\n        button.initialized = true;\n    }\n\n    button.addEventListener('click', (e) => editTableModal(e, idstring, encodedtable));\n    addFilterButtonListener(selector, idstring, encodedtable);\n\n}\n\n/**\n * Edit Table Modal.\n * @param {*} selector\n * @param {*} idstring\n * @param {*} encodedtable\n */\nexport function addFilterButtonListener(selector, idstring, encodedtable) {\n    const button = verifyValidButtonInitialisation(selector);\n    if (button) {\n        button.addEventListener('click', (e) => addFilterTableModal(e, idstring, encodedtable));\n    }\n    return;\n}\n\n/**\n * Edit Table Modal.\n * @param {*} selector\n */\nexport function verifyValidButtonInitialisation(selector) {\n    const button = document.querySelector(selector + SELECTORS.ADDFILTERBUTTON);\n    if (!button) {\n        return false;\n    }\n    if (button.initialized) {\n        return false;\n    } else {\n        button.initialized = true;\n    }\n    return button;\n}\n\n/**\n * Edit Table Modal.\n * @param {*} event\n * @param {*} idstring\n * @param {*} encodedtable\n */\nexport function addFilterTableModal(event, idstring, encodedtable) {\n    // We two parents up, we find the right element with the necessary information.\n    const element = event.target;\n    const modalForm = new ModalForm({\n        formClass: \"local_wunderbyte_table\\\\form\\\\addfitlertable\",\n        args: {\n            idstring,\n            encodedtable,\n        },\n        modalConfig: {title: getString('addwbtablefilter', 'local_wunderbyte_table')},\n        returnFocus: element\n    });\n    modalForm.addEventListener('core_form_modalform_loaded', () => {\n        filterFieldsInit();\n    });\n    modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, response => {\n        // eslint-disable-next-line no-console\n        console.log('form submitted response: ', response);\n        window.location.reload();\n    });\n    modalForm.show();\n}\n\n/**\n * Edit Table Modal.\n * @param {*} event\n * @param {*} idstring\n * @param {*} encodedtable\n */\nexport function editTableModal(event, idstring, encodedtable) {\n\n    // We two parents up, we find the right element with the necessary information.\n    const element = event.target;\n\n    // eslint-disable-next-line no-console\n    console.log('closest', element);\n\n    // eslint-disable-next-line no-console\n    console.log('values ', idstring);\n\n    const modalForm = new ModalForm({\n\n        // Name of the class where form is defined (must extend \\core_form\\dynamic_form):\n        formClass: \"local_wunderbyte_table\\\\form\\\\edittable\",\n        // Add as many arguments as you need, they will be passed to the form:\n        args: {\n            idstring,\n            encodedtable,\n        },\n        // Pass any configuration settings to the modal dialogue, for example, the title:\n        modalConfig: {title: getString('customizewbtable', 'local_wunderbyte_table')},\n        // DOM element that should get the focus after the modal dialogue is closed:\n        returnFocus: element\n    });\n    // Listen to events if you want to execute something on form submit.\n    // Event detail will contain everything the process() function returned:\n    modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, response => {\n\n        // eslint-disable-next-line no-console\n        console.log('form submitted response: ', response);\n\n        window.location.reload();\n    });\n\n    // Show the form.\n    modalForm.show();\n\n}\n"],"names":["e","selector","idstring","encodedtable","button","document","querySelector","SELECTORS","EDITTABLEBUTTON","initialized","addEventListener","editTableModal","addFilterButtonListener","_modalform","__esModule","default","ADDFILTERBUTTON","verifyValidButtonInitialisation","addFilterTableModal","event","element","target","modalForm","ModalForm","formClass","args","modalConfig","title","getString","returnFocus","filterFieldsInit","events","FORM_SUBMITTED","response","console","log","window","location","reload","show"],"mappings":"2LAoB4C,IAAAA;;;;;iPAerC,SAAmCC,SAAUC,SAAUC,cAE1D,MAAMC,OAASC,SAASC,cAAcL,SAAWM,UAAUC,iBAE3D,IAAKJ,OACD,OAGJ,GAAIA,OAAOK,YACP,OAEAL,OAAOK,aAAc,EAGzBL,OAAOM,iBAAiB,SAAUV,GAAMW,eAAeX,EAAGE,SAAUC,gBACpES,wBAAwBX,SAAUC,SAAUC,aAEhD,2EAhCAU,YAA4Cb,EAA5Ca,aAA4Cb,EAAAc,WAAAd,EAAAe,CAAAA,QAAAf,GAI5C,MAAMO,UAAY,CACdC,gBAAiB,mBACjBQ,gBAAiB,0BAkCd,SAASJ,wBAAwBX,SAAUC,SAAUC,cACxD,MAAMC,OAASa,gCAAgChB,UAC3CG,QACAA,OAAOM,iBAAiB,SAAUV,GAAMkB,oBAAoBlB,EAAGE,SAAUC,eAGjF,CAMO,SAASc,gCAAgChB,UAC5C,MAAMG,OAASC,SAASC,cAAcL,SAAWM,UAAUS,iBAC3D,QAAKZ,UAGDA,OAAOK,cAGPL,OAAOK,aAAc,EAElBL,QACX,CAQO,SAASc,oBAAoBC,MAAOjB,SAAUC,cAEjD,MAAMiB,QAAUD,MAAME,OAChBC,UAAY,IAAIC,WAAAA,QAAU,CAC5BC,UAAW,+CACXC,KAAM,CACFvB,kBACAC,2BAEJuB,YAAa,CAACC,OAAO,EAAAC,KAAAA,YAAU,mBAAoB,2BACnDC,YAAaT,UAEjBE,UAAUZ,iBAAiB,8BAA8B,MACrD,EAAAoB,oBAAAA,OAAkB,IAEtBR,UAAUZ,iBAAiBY,UAAUS,OAAOC,gBAAgBC,WAExDC,QAAQC,IAAI,4BAA6BF,UACzCG,OAAOC,SAASC,QAAQ,IAE5BhB,UAAUiB,MACd,CAQO,SAAS5B,eAAeQ,MAAOjB,SAAUC,cAG5C,MAAMiB,QAAUD,MAAME,OAGtBa,QAAQC,IAAI,UAAWf,SAGvBc,QAAQC,IAAI,UAAWjC,UAEvB,MAAMoB,UAAY,IAAIC,WAAAA,QAAU,CAG5BC,UAAW,0CAEXC,KAAM,CACFvB,kBACAC,2BAGJuB,YAAa,CAACC,OAAO,EAAAC,KAAAA,YAAU,mBAAoB,2BAEnDC,YAAaT,UAIjBE,UAAUZ,iBAAiBY,UAAUS,OAAOC,gBAAgBC,WAGxDC,QAAQC,IAAI,4BAA6BF,UAEzCG,OAAOC,SAASC,QAAQ,IAI5BhB,UAAUiB,MAEd,CAAC"}
define("local_wunderbyte_table/edittable",["exports","core/ajax","core_form/modalform","core/str","local_wunderbyte_table/filterfieldsreload","local_wunderbyte_table/filtercolumnsreload","local_wunderbyte_table/deletekeyvaluepair"],(function(_exports,_ajax,_modalform,_str,_filterfieldsreload,_filtercolumnsreload,_deletekeyvaluepair){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * @module    local_wunderbyte_table
   * @copyright  Wunderbyte GmbH <info@wunderbyte.at>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.addFilterButtonListener=addFilterButtonListener,_exports.addFilterTableModal=addFilterTableModal,_exports.editTableModal=editTableModal,_exports.initializeEditTableButton=function(selector,idstring,encodedtable){const button=document.querySelector(selector+SELECTORS_EDITTABLEBUTTON);if(!button)return;if(button.initialized)return;button.initialized=!0;button.addEventListener("click",(e=>editTableModal(e,idstring,encodedtable))),addFilterButtonListener(selector,idstring,encodedtable)},_exports.verifyValidButtonInitialisation=verifyValidButtonInitialisation,_ajax=_interopRequireDefault(_ajax),_modalform=_interopRequireDefault(_modalform);const SELECTORS_EDITTABLEBUTTON=" .wb_edit_button",SELECTORS_ADDFILTERBUTTON=" .wb_add_filter_button";function addFilterButtonListener(selector,idstring,encodedtable){const button=verifyValidButtonInitialisation(selector);button&&button.addEventListener("click",(e=>addFilterTableModal(e,idstring,encodedtable)))}function verifyValidButtonInitialisation(selector){const button=document.querySelector(selector+SELECTORS_ADDFILTERBUTTON);return!!button&&(!button.initialized&&(button.initialized=!0,button))}function addFilterTableModal(event,idstring,encodedtable){const element=event.target,modalForm=new _modalform.default({formClass:"local_wunderbyte_table\\form\\addfiltertable",args:{idstring:idstring,encodedtable:encodedtable},modalConfig:{title:(0,_str.get_string)("addwbtablefilter","local_wunderbyte_table")},returnFocus:element});modalForm.addEventListener("core_form_modalform_loaded",(()=>{(0,_filterfieldsreload.init)(),(0,_filtercolumnsreload.init)(encodedtable),(0,_deletekeyvaluepair.init)()})),modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(response=>{console.log("form submitted response: ",response),window.location.reload()})),modalForm.addEventListener("change",(e=>{"subdatepicker_type"==e.target.name&&_ajax.default.call([{methodname:"local_wunderbyte_table_get_filter_specific_fields",args:{filterspecifictype:e.target.value},done:response=>{const filteradd=document.getElementById("filter-add-field");filteradd&&response.filteraddfields&&(filteradd.innerHTML=response.filteraddfields)},fail:error=>{console.error("Web service error:",error)}}])})),modalForm.show()}function editTableModal(event,idstring,encodedtable){const element=event.target;console.log("closest",element),console.log("values ",idstring);const modalForm=new _modalform.default({formClass:"local_wunderbyte_table\\form\\edittable",args:{idstring:idstring,encodedtable:encodedtable},modalConfig:{title:(0,_str.get_string)("customizewbtable","local_wunderbyte_table")},returnFocus:element});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(response=>{console.log("form submitted response: ",response),window.location.reload()})),modalForm.show()}}));

//# sourceMappingURL=edittable.min.js.map